import mlflow
from configparser import ConfigParser
from mlflow_mng.model import MlflowModel

def process():
    config = ConfigParser()
    config.read('core/config.ini')
    server_url = config['mlflow']['protocol.server'] + '://' + config['mlflow']['ip.server'] + ':' + config['mlflow']['port.server']
    mlflow.set_tracking_uri(server_url)
    
    # load_model
    mlflow_model = MlflowModel(mlflow)
    model_name_list = mlflow_model.get_model_name_list()
    model_name = model_name_list[0] if model_name_list[0] == 'intent_classifier' else 'intent_classifier'
    model_uri = mlflow_model.get_latest_version_uri(model_name = model_name) # 또는 직접 지정할 수도 있음 model_uri = 'models:/intent_classifier/5'
    mlflow_model = MlflowModel(mlflow)
    model = mlflow_model.load_model(model_uri)
    
    # predict
    question_embedding = [0.05851084366440773, -0.03908400237560272, -0.0016643720446154475, 0.0046141427010297775, 0.01764826662838459, 0.0053138118237257, 0.029330631718039513, -0.029481949284672737, -0.0005228535737842321, 0.01677343249320984, 0.06251811236143112, -0.01988660916686058, 0.04611838981509209, -0.025034548714756966, 0.061544567346572876, 0.03255869448184967, -0.023580091074109077, -0.0409928523004055, -0.09187929332256317, 0.022343453019857407, 0.04796496033668518, -0.06538821011781693, 0.04297511279582977, -0.0059728678315877914, -0.04527104273438454, -0.018054824322462082, -0.08293919265270233, 0.012298048473894596, 0.024624429643154144, 0.010756139643490314, 0.07178586721420288, 0.00021448331244755536, 0.02138122171163559, -0.018785104155540466, -0.018878694623708725, -0.010429135523736477, 0.042935412377119064, -0.021326061338186264, -0.10491766035556793, -0.0989416241645813, -0.008632590062916279, 0.01640802063047886, 0.07877298444509506, 0.006167418789118528, 0.013337740674614906, 0.068733349442482, -0.018765294924378395, -0.04066786915063858, -0.07108782976865768, -0.05579826608300209, 0.016450708732008934, -0.0669046938419342, 0.006936780642718077, 0.02844533510506153, -0.04499267414212227, 0.0926886796951294, 0.029517887160182, -0.06412684172391891, -0.08494254946708679, -0.043299008160829544, -0.082126684486866, -0.030766179785132408, -0.020107967779040337, 0.09262719005346298, 0.07662990689277649, 0.023843897506594658, -0.003879358060657978, -0.07663393765687943, 0.017472846433520317, -0.0036780964583158493, -0.058585651218891144, 0.00212135654874146, -0.09230805188417435, -0.05678415670990944, 0.055893104523420334, 0.03636792302131653, -0.0075894310139119625, -0.0474650077521801, 0.17477449774742126, 0.028139648959040642, 0.02006024867296219, -0.01402987726032734, -0.009656808339059353, 0.11069004982709885, -0.08107014745473862, 0.04447057098150253, 0.008962470106780529, -0.031588491052389145, -0.001541827223263681, -0.02386592887341976, -0.022384146228432655, 0.005906416103243828, 0.02896950952708721, 0.02517818845808506, 0.10966245830059052, -0.010183203965425491, -0.056901272386312485, -0.07301481813192368, 0.06080258637666702, 0.11762434989213943, -0.04511246085166931, -0.09023111313581467, -0.05669866129755974, -0.014889387413859367, 0.0022086685057729483, -0.03135105222463608, 0.030417190864682198, -0.1455915868282318, 0.0765748843550682, -0.038072071969509125, 0.020911555737257004, 9.075412526726723e-05, 0.02537233941257, 0.07256494462490082, -0.03329043835401535, 0.02378620021045208, -0.021991465240716934, 0.06583423167467117, 0.0583292655646801, -0.06541264802217484, 0.014509228058159351, -0.06303896754980087, 0.09056024998426437, 0.013285272754728794, 0.023592133074998856, -0.0769854187965393, -0.07030843943357468, -0.03592095151543617, -0.0459103137254715, -0.05751127377152443, 0.10945924371480942, -0.05402260646224022, 0.0010001687332987785, 0.01225666981190443, -0.001814320683479309, 0.003223336534574628, 0.06147194653749466, -0.048193447291851044, -0.06759904325008392, 0.050859179347753525, 0.036905840039253235, 0.08196034282445908, 0.06037542223930359, 0.06764129549264908, 0.017854386940598488, 0.08701281994581223, -0.013438495807349682, 0.01837579905986786, -0.0051530757918953896, 0.02181488648056984, -0.0448770597577095, 0.004579792730510235, 0.07333290576934814, -0.05022817850112915, 0.007816429249942303, 0.028352156281471252, -0.012070232070982456, 0.03920448571443558, -0.0593157559633255, 0.016471177339553833, -0.0633738711476326, -0.01663685031235218, -0.00977674126625061, 0.03439703583717346, 0.00660582585260272, -0.027337081730365753, -0.03067951649427414, -0.03598519042134285, -0.010699683800339699, 0.14980548620224, -0.010527154430747032, -0.0878634974360466, -0.0287914015352726, -0.09680752456188202, -0.022217722609639168, 0.0039914445951581, -0.030317312106490135, 0.030525216832756996, -0.0185032170265913, -0.01939324662089348, 0.024179397150874138, -0.06594684720039368, 0.07660272717475891, 0.012039023451507092, 0.09300964325666428, 0.002129914704710245, -0.009003816172480583, 0.07628665864467621, -0.11094928532838821, -0.0323968231678009, -0.01978139765560627, 0.008357541635632515, 0.07584474980831146, 0.12311477959156036, 0.03078157640993595, -0.004820412490516901, 0.08391562849283218, 0.008211269043385983, -0.003827006323263049, -0.01296669989824295, -0.07512946426868439, 0.05312325432896614, 0.03564012795686722, -0.0756528303027153, -0.10817449539899826, -0.06281637400388718, -0.02900504879653454, 0.019789569079875946, -0.05777065083384514, 0.09530949592590332, -0.08864064514636993, -0.04104624316096306, -0.1331799179315567, -0.05235319584608078, -0.05027666687965393, -0.012454853393137455, -0.012246341444551945, 0.022127801552414894, -0.025110745802521706, -0.027989348396658897, -0.047182705253362656, 0.023199690505862236, -0.03574618697166443, -0.04102684557437897, -0.10132835060358047, -0.118031345307827, -0.11998701095581055, 0.012663152068853378, -0.024512721225619316, 0.0319727286696434, 0.07371649146080017, -0.007018082309514284, 0.11714134365320206, 0.10639451444149017, 0.01068802084773779, -0.0006550215766765177, -0.029420580714941025, 0.04863964021205902, 0.000357760232873261, -0.0258651003241539, -0.006971877533942461, -0.04757516086101532, 0.006977018900215626, 0.034043412655591965, 0.07400670647621155, 0.0543496273458004, -0.007269872818142176, -0.038440268486738205, -0.029281245544552803, 0.07500679045915604, -0.05118456855416298, 0.05940669775009155, 0.01618560589849949, -0.0542043037712574, 0.012850631028413773, -0.010596690699458122, -0.014947770163416862, 0.043694596737623215, 0.048370860517024994, 0.018797600641846657, 0.030064789578318596, -0.06733042746782303, 0.03688599914312363, 0.029966382309794426, 0.0031080879271030426, 0.012436826713383198, -0.009969864971935749, 0.0018986932700499892, -0.013025437481701374, -0.018379051238298416, 0.02781359851360321, 0.035788390785455704, 0.05641281604766846, -0.07254898548126221, -0.04193812981247902, -0.04310919716954231, -0.045577067881822586, -0.06575269252061844, 0.007402820512652397, 0.017617782577872276, 0.014480731450021267, 0.07239730656147003, 0.00749721797183156, 0.004702921025454998, 0.025059103965759277, -0.06146598234772682, 0.03287101164460182, 0.015143584460020065, -0.1179005354642868, 0.004695666953921318, 0.004019169602543116, -0.025590356439352036, -0.036945365369319916, 0.018332812935113907, -0.011720294132828712, 0.0055635226890444756, 0.1115131601691246, -0.02183425985276699, -0.07878408581018448, 0.03988823667168617, 0.02361215464770794, 0.057665955275297165, 0.07227563112974167, -0.05449198931455612, -0.0844995379447937, 0.0040299007669091225, 0.04985906928777695, 0.018667351454496384, 0.019820449873805046, 0.06036457419395447, -0.011577008292078972, -0.14783477783203125, -0.050599947571754456, -0.0778798833489418, 0.0512205995619297, 0.03232211992144585, -0.02095709554851055, -0.03257131576538086, -0.00874252151697874, -0.04337744414806366, 0.026832541450858116, 0.003365504089742899, -0.003499460406601429, 0.02663462981581688, -0.011022559367120266, 0.01475740410387516, -0.040250811725854874, 0.02067253366112709, 0.003061105264350772, -0.033337242901325226, 0.061320945620536804, -0.048363491892814636, 0.023028472438454628, 0.011991528794169426, 0.06438153982162476, 0.06806976348161697, 0.035621337592601776, 0.04118064418435097, -0.022478215396404266, -0.04491643235087395, 0.08303176611661911, 0.02521180547773838, -0.04105160012841225, 0.023267176002264023, -0.026036279276013374, 0.03834912180900574, 0.060190871357917786, -0.01280626654624939, 0.03366337716579437, -0.0256977416574955, -0.021859701722860336, 0.06549176573753357, -0.026161128655076027, -0.026696955785155296, 0.07478081434965134, 0.010325588285923004, -0.017584672197699547, -0.047661490738391876, 0.05748428776860237, 0.018976276740431786, 0.010756820440292358, -0.0037188453134149313, -0.013129961676895618, -0.011194235645234585, 0.10990072041749954, 0.030971277505159378, 0.028752749785780907, -0.10914795845746994, -0.020985892042517662, 0.019567953422665596, -0.0349789634346962, 0.045707859098911285, 0.0296810120344162, 0.05209751054644585, 0.015315338969230652, -0.007902580313384533, -0.0014090955955907702, -0.037070076912641525, 0.043296195566654205, 0.011287122033536434, 0.04773520305752754, 0.0038929875008761883, -0.0013660858385264874, -0.005137905012816191]
    result = model.predict(question_embedding)
    print(result)